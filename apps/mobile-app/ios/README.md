# SpeakBetter iOS Configuration

This directory contains iOS-specific configuration for the SpeakBetter AI Coach app.

## Environment Variables

The app uses `react-native-config` to manage environment variables. Follow these steps to set up environment variables in your iOS build:

### 1. Configuration Files

- **Config.xcconfig**: Main configuration file for the iOS app that includes environment variables
- **tmp.xcconfig**: Temporary file generated by react-native-config during the build process

### 2. Setting Up Xcode Project

1. Open your Xcode project
2. Go to Project Navigator > Your Project > Info
3. Under "Configurations", select "Config.xcconfig" for both Debug and Release configurations

### 3. Accessing Environment Variables in iOS Code

You can access environment variables in your native code:

```objective-c
#import "RNCConfig.h"

// Get a single value
NSString *apiKey = [RNCConfig envFor:@"FIREBASE_API_KEY"];

// Use in Info.plist
// Add $(FIREBASE_API_KEY) in your Info.plist for values that should be configured at build time
```

### 4. Injecting Variables into Info.plist

To inject variables into Info.plist, add a Run Script Phase to your Build Phases:

1. Open Xcode project
2. Go to your target's Build Phases
3. Click "+" to add a new Run Script Phase
4. Enter the following script:

```bash
"${SRCROOT}/../node_modules/react-native-config/ios/ReactNativeConfig/BuildXCConfig.rb" "${SRCROOT}/.." "${SRCROOT}/tmp.xcconfig"
```

5. Make sure this script runs before "Copy Bundle Resources"

### 5. Required Environment Variables

The following variables must be defined in your .env file:

- `FIREBASE_API_KEY`
- `FIREBASE_AUTH_DOMAIN`
- `FIREBASE_PROJECT_ID`
- `FIREBASE_STORAGE_BUCKET`
- `FIREBASE_MESSAGING_SENDER_ID`
- `FIREBASE_APP_ID`
- `GOOGLE_CLOUD_API_KEY`
- `APP_ENV`
- `API_URL`

### 6. Example Native Module

`EnvHelper.m.example` demonstrates how to create a native module that exposes environment variables to JavaScript. To use it:

1. Create a new Objective-C file in your Xcode project
2. Copy the contents of the example file
3. Use the JavaScript interface in `src/services/EnvHelper.ts`

## Audio Session Configuration

For audio recording functionality, the app needs proper audio session configuration. Make sure these settings are in your Info.plist:

```xml
<key>NSMicrophoneUsageDescription</key>
<string>SpeakBetter needs microphone access to record your speech for analysis.</string>
<key>UIBackgroundModes</key>
<array>
    <string>audio</string>
</array>
```
